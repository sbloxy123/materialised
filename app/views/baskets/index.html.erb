<% sum = 0 %>
<% @basket_items.each do |item| %>
  <% sum += @materials.find(item.material_id).price %>
<% end %>

<div class="container">
      <h2 class= mt-3> Order Summary </h2>

  <div class="border p-3 mt-3 position-relative w-80 m-auto">
    <div class="m-3">

      <%# TODO: add details from order controller %>
      <h3> Delivery Address: </h3>
      <p>** to be taken from the orders controller</p>


      <%# TODO: add delivery fee algorithm? %>
      <p>Delivery and handling fee: £ xxx <- to be calculated..?</p>
      <% tax_amount = sum/20.to_f %>
      <p>Tax = £ <%= sprintf("%.2f", tax_amount) %> </p>
      <h3>total:  £<%= sprintf("%.2f", sum) %></h3>
      <p class="w-50">Notice: one or more of your items is more than 3 metres so a surcharge of £9.99 has been added to the delivery fee</p>
    </div>
    <%= link_to "PAY NOW", baskets_path, "class" => "orange-button position-absolute bottom-0 end-0 m-3"%>
  </div>
<h1 class= my-3>Items in your basket</h1>
<div id="index-grid">
    <% @basket_items.each do |item| %>
    <div class="container card-border">
        <div class="container d-flex gap-30 mt-5 pb-5 border-bottom">
          <img src="https://images.unsplash.com/photo-1438761681033-6461ffad8d80?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=2070&q=80" alt="" id="img-test">
          <div class="name-des">
            <h5><%= @materials.find(item.material_id).name %></h5>
            <p><%= @materials.find(item.material_id).description %></p>
          </div>
        </div>
        <div class="d-flex space-between">
          <div>
          <p class="mt-2">Input for quantity</p>
          <p>Vehicle image and type</p>
          </div>
          <div>
            <p class="mt-2">£<%=@materials.find(item.material_id).price %></p>
            <%= link_to "View details", material_path(item.material_id) %>
          </div>
        </div>
      </div>
    <% end %>
    </div>
  </div>
</div>

<%= render partial: "shared/basket" %>
